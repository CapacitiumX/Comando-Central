<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Command Center">
    <meta name="theme-color" content="#121212">

    <title>COMMAND CENTER 29.0 | CAPACITIUMX</title>

    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%23121212'/><path d='M50 15 L30 55 L50 55 L40 85 L70 45 L50 45 L60 15 Z' fill='%230d6efd'/></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%23121212'/><path d='M50 15 L30 55 L50 55 L40 85 L70 45 L50 45 L60 15 Z' fill='%230d6efd'/></svg>">

    <script>
        const myManifest = {
            "name": "Command Center 29.0",
            "short_name": "Hub Pro",
            "start_url": ".",
            "display": "standalone",
            "background_color": "#121212",
            "theme_color": "#0d6efd",
            "icons": [{
                "src": "https://cdn-icons-png.flaticon.com/512/906/906343.png",
                "sizes": "512x512",
                "type": "image/png",
                "purpose": "any maskable"
            }]
        };
        const blob = new Blob([JSON.stringify(myManifest)], {type: 'application/json'});
        const manifestURL = URL.createObjectURL(blob);
        const link = document.createElement('link');
        link.rel = 'manifest';
        link.href = manifestURL;
        document.head.appendChild(link);
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');

        :root {
            --bg: #121212;
            --card-bg: #1e1e1e;
            --text: #e0e0e0;
            --accent: #0d6efd; 
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        h1, h2 { text-align: center; color: white; margin-bottom: 10px; }
        .subtitle { text-align: center; color: #888; margin-bottom: 40px; font-size: 0.9rem; }

        /* BUSCADOR */
        .search-hero {
            background: #252525; padding: 20px; border-radius: 12px;
            text-align: center; margin-bottom: 40px; border: 1px solid #333;
        }
        .hero-input {
            width: 100%; max-width: 600px; padding: 15px; font-size: 1.2rem;
            background: #111; border: 2px solid #444; color: white;
            border-radius: 8px; text-align: center; transition: 0.3s;
        }
        .hero-input:focus { border-color: var(--accent); outline: none; }

        .section-header {
            border-bottom: 1px solid #333; margin: 50px 0 20px 0;
            padding-bottom: 10px; color: #888; font-size: 1.1rem;
            text-transform: uppercase; font-weight: bold; letter-spacing: 1px;
        }

        /* GRID */
        .app-grid {
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); 
            gap: 15px;
        }

        .app-card {
            background: var(--card-bg); border: 1px solid #333; border-radius: 12px;
            padding: 15px 5px; text-align: center; cursor: pointer;
            transition: all 0.2s ease; display: flex; flex-direction: column;
            align-items: center; justify-content: center; height: 110px;
            color: var(--text); position: relative; overflow: hidden;
            border-top: 3px solid #555;
            text-decoration: none;
        }
        .app-card:hover { transform: translateY(-5px); background: #2a2a2a; border-color: white; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .app-card .icon { font-size: 1.8rem; margin-bottom: 8px; }
        .app-card .title { font-size: 0.8rem; font-weight: 500; line-height: 1.2; }

        /* VISTAS */
        .app-view { display: none; padding-top: 20px; animation: fadeIn 0.3s; }
        .app-view.active { display: block; }
        .btn-back {
            background: #333; color: white; padding: 10px 25px; border-radius: 30px;
            border: none; cursor: pointer; display: inline-flex; align-items: center; gap: 10px;
            margin-bottom: 20px; font-weight: bold;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* ESTILOS FACTURA */
        .logo-section { display: flex; justify-content: center; margin-bottom: 40px; }
        .logo-area {
            width: 120px; height: 120px; border-radius: 50%; border: 2px dashed #555;
            display: flex; align-items: center; justify-content: center; overflow: hidden;
            background-color: #000; cursor: pointer;
        }
        .logo-area img { width: 100%; height: 100%; object-fit: cover; display: none; }
        #logoInput { display: none; }

        .data-section { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 40px; }
        @media (max-width: 768px) { .data-section { grid-template-columns: 1fr; } }
        .box { background: #1a1a1a; padding: 25px; border-radius: 8px; border: 1px solid #333; }
        
        input, select { 
            width: 100%; padding: 12px 10px; background: #252525; border: 1px solid #444; 
            color: white; border-radius: 5px; margin-bottom: 15px; box-sizing: border-box; 
        }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 15px 10px; border-bottom: 1px solid #333; text-align: left; }
        .btn-action { width: 100%; padding: 15px; background: var(--accent); color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 1.1rem; margin-top: 20px;}

        /* IMPRESI√ìN LIMPIA */
        @media print {
            body { background: white !important; color: black !important; padding: 2cm; }
            .app-view:not(.active) { display: none; }
            .btn-back, .btn-action, .print-hidden { display: none !important; }
            input { border: none !important; border-bottom: 1px solid #000 !important; color: black !important; background: transparent !important; }
        }
    </style>
</head>
<body>

    <div class="container">

        <div id="main-menu" class="app-view active">
            <h1>COMMAND CENTER 29.0</h1>
            <div class="subtitle">Suite Completa de Aplicaciones | CAPACITIUMX</div>

            <div class="search-hero">
                <label>üéØ Busca tu pr√≥ximo empleo:</label>
                <input type="text" id="targetJob" class="hero-input" placeholder="Ej. Docente, Abogado..." onkeyup="saveConfig()">
            </div>

            <div class="section-header">üîß Herramientas Pro</div>
            <div class="app-grid">
                <div class="app-card" onclick="openView('view-factura')" style="border-top-color: #00ffcc;"><div class="icon">üìë</div><div class="title">Facturador</div></div>
                <div class="app-card" onclick="openView('view-crm')" style="border-top-color: #ff0055;"><div class="icon">üìÇ</div><div class="title">CRM</div></div>
            </div>

            <div class="section-header">üåê Internet & Social</div>
            <div class="app-grid">
                <div class="app-card" onclick="go('https://mail.google.com/')"><div class="icon">üìß</div><div class="title">Gmail</div></div>
                <div class="app-card" onclick="go('https://web.whatsapp.com/')"><div class="icon">üü¢</div><div class="title">WhatsApp</div></div>
                <div class="app-card" onclick="go('https://www.facebook.com/')"><div class="icon">üìò</div><div class="title">Facebook</div></div>
                <div class="app-card" onclick="go('https://www.google.com/')"><div class="icon">üåê</div><div class="title">Google</div></div>
                <div class="app-card" onclick="go('https://chatgpt.com/')"><div class="icon">ü§ñ</div><div class="title">ChatGPT</div></div>
            </div>

            <div class="section-header">üíº Empleo Monterrey</div>
            <div class="app-grid">
                <div class="app-card" onclick="searchJob('linkedin')"><div class="icon">üîµ</div><div class="title">LinkedIn</div></div>
                <div class="app-card" onclick="searchJob('occ')"><div class="icon">üî¥</div><div class="title">OCC</div></div>
                <div class="app-card" onclick="searchJob('indeed')"><div class="icon">üîç</div><div class="title">Indeed</div></div>
            </div>
            
            <div class="section-header">üçø Ocio</div>
            <div class="app-grid">
                <div class="app-card" onclick="go('https://www.youtube.com/')"><div class="icon">‚ñ∂</div><div class="title">YouTube</div></div>
                <div class="app-card" onclick="go('http://googleusercontent.com/spotify.com/3')"><div class="icon">üéß</div><div class="title">Spotify</div></div>
            </div>
        </div>

        <div id="view-factura" class="app-view">
            <button class="btn-back" onclick="openView('main-menu')">üè† Men√∫</button>
            <h2>Generador de Documentos</h2>
            <div class="logo-section">
                <div class="logo-area" onclick="document.getElementById('logoInput').click()">
                    <img id="logoPreview" src="" alt="Logo">
                    <span id="logoText">Subir Logo</span>
                </div>
                <input type="file" id="logoInput" accept="image/*" onchange="loadLogo(event)">
            </div>
            <div class="data-section">
                <div class="box">
                    <h3>Emisor</h3>
                    <input type="text" id="emiName" placeholder="Tu Nombre" onkeyup="saveInv()">
                    <input type="text" id="emiRFC" placeholder="RFC" onkeyup="saveInv()">
                </div>
                <div class="box">
                    <h3>Cliente</h3>
                    <input type="text" id="cliName" placeholder="Cliente" onkeyup="saveInv()">
                    <input type="date" id="docDate" onchange="saveInv()">
                </div>
            </div>
            <button class="btn-action" onclick="window.print()">üñ®Ô∏è Imprimir PDF</button>
        </div>

        <div id="view-crm" class="app-view">
            <button class="btn-back" onclick="openView('main-menu')">üè† Men√∫</button>
            <h2>CRM de Contactos</h2>
            <div class="box" style="display:flex; gap:10px;">
                <input type="text" id="crmComp" placeholder="Empresa...">
                <input type="text" id="crmRole" placeholder="Contacto...">
                <button class="btn-action" style="width:80px; margin-top:0;" onclick="addCrm()">‚ûï</button>
            </div>
            <div class="box">
                <table id="crmTable"><tbody id="crmBody"></tbody></table>
            </div>
        </div>

    </div>

    <script>
        function openView(id) {
            document.querySelectorAll('.app-view').forEach(el => el.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            window.scrollTo(0,0);
        }

        function go(url) { window.open(url, '_blank'); }

        // PERSISTENCIA
        const jInput = document.getElementById('targetJob');
        jInput.value = localStorage.getItem('hub_job_v29') || "";
        function saveConfig() { localStorage.setItem('hub_job_v29', jInput.value); }

        function searchJob(plat) {
            const v = jInput.value.trim();
            const q = v.replace(/\s+/g,'+');
            let u = "";
            if(plat==='linkedin') u = `https://www.linkedin.com/jobs/search?keywords=${q}`;
            if(plat==='occ') u = `https://www.occ.com.mx/empleos/de-${q}/`;
            if(plat==='indeed') u = `https://mx.indeed.com/jobs?q=${q}`;
            window.open(u, '_blank');
        }

        // CRM LOGIC
        let db = JSON.parse(localStorage.getItem('crm_db_v29')) || [];
        function renderCrm() {
            const t = document.getElementById('crmBody'); t.innerHTML="";
            db.forEach((x, i) => {
                t.innerHTML += `<tr><td>${x.c}</td><td>${x.r}</td><td><button onclick="delCrm(${i})">‚ùå</button></td></tr>`;
            });
        }
        function addCrm() {
            const c=document.getElementById('crmComp').value, r=document.getElementById('crmRole').value;
            if(c&&r) { db.push({c,r}); localStorage.setItem('crm_db_v29',JSON.stringify(db)); renderCrm(); }
        }
        function delCrm(i) { db.splice(i,1); localStorage.setItem('crm_db_v29',JSON.stringify(db)); renderCrm(); }
        renderCrm();

        // SERVICE WORKER PARA ACTIVAR INSTALACI√ìN
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                const swCode = `self.addEventListener('fetch', function(event) {});`;
                const blob = new Blob([swCode], {type: 'application/javascript'});
                const url = URL.createObjectURL(blob);
                navigator.serviceWorker.register(url);
            });
        }
    </script>
</body>
</html>
